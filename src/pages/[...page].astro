---
import Layout from '../layouts/layout.astro';
import type { Article } from '../components/article-element.astro';
import ArticlesContainer from '../components/articles-container.astro';
import PaginationBar from '../components/pagination-bar.astro';

export async function getStaticPaths({paginate}) {
    const posts = await Astro.glob('./articles/*.mdx');

    const getArticles = (): Article[] => {
        const articles = posts.map((post) => {
            return {
                link: post.url as string,
                articleTitle: post.title,
                publishedAt: post.publishedAt,
                description: post.description as string,
            }
        });

        const articlesOrderedByMostRecent = articles.sort((a, b) => b.publishedAt - a.publishedAt);

        return articlesOrderedByMostRecent;

    };
    const articles = getArticles();

    return paginate(articles, {pageSize: 5})
}

const { page } = Astro.props;
---

<Layout title="Einenlum - Coding amongst alpacas and pinball machines" description="Notes and lessons learned in software development - PHP, Python, tooling, and more. Creator of a Python course for PHP developers.">
	<ArticlesContainer articles={page.data} />

    <PaginationBar prevUrl={page.url.prev} nextUrl={page.url.next} currentPage={page.currentPage} totalPages={page.lastPage} />
</Layout>
